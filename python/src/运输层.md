# 运输层

## 重要概念

- 复用：不同应用进程将数据交给运输层，共用运输层
- 分用： 运输层收到网络层上交的数据后，可以将数据分开，分别递交到不同的应用进程中
- 套接字：（ip：端口号）

## udp

- udp首部格式（8字节）

  ```
  源端口号：2字节
  目的端口号：2字节
  长度：udp数据报总长度(头+data)2字节
  检验和：2字节和IP数据报校验类似，IP数据报只校验头部，而udp校验包括头部和数据部分
  ```

  

- udp没有流量控制功能，往往是应用层递交多大数据，udp协议就将多大数据一次性打包成udp数据报。

## tcp

- tcp首部格式

  ```
  源端口：
  目的端口：
  序号：在建立连接时就建立数据流序号，确定本报文段起始字节流的序号。
  确认号：序号+数据流长度。
  数据偏移：确定报文段头部。
  保留：当前为空。
  URG：紧急URG，报文段该值为1时，发送优先级提高。(ctl+c)
  ACK：建立连接时使用，ACK=1&&SYN=0时(连接请求报文)，ACK=1&&SYN=1(连接接受报文)。
  PSH：当PSH=1时，立即交付应用进程，而不需等到tcp缓存满了再交付。
  RST：当连接或报文段在传送的过程中发生致命错误的时候，将RST置为1.重新建立运输层连接。
  SYN：建立连接时使用，ACK=1&&SYN=0时(连接请求报文)，ACK=1&&SYN=1(连接接受报文)。
  FIN：用来释放一个链接。
  窗口：用来告诉对方，下一次发送数据的数据量，占2字节。
  校验和：用来校验报文段是否正确传输。
  紧急指针：配合URG字段使用，紧急指针后的为普通数据，可以正常传输。
  选项：最大40个字节，与上方数据偏移有关系，数据偏移占4位，最大表示的十进制数据是15，然而数据偏移字段的单位是4字节，所以15*4=60字节，这60字节是tcp报文段的头部总长度，减去固定的20字节，所以选项字段最大为40字节。
  ```

- 

